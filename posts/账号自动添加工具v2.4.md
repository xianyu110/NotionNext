---
title: "è´¦å·è‡ªåŠ¨æ·»åŠ å·¥å…·v2.4"
date: Fri Jan 02 2026 23:54:14 GMT+0800 (China Standard Time)
category: "èµ„æºåŒº"
tags: ["#css","#css3","#å‰ç«¯"]
summary: ""
author: "xianyu120"
status: "Published"
---


    // ==UserScript==
    // @name         Claude-Shareè´¦å·è‡ªåŠ¨æ·»åŠ å·¥å…· v2.4 (è‡ªåŠ¨å¯ç”¨çŠ¶æ€)
    // @namespace    http://tampermonkey.net/
    // @version      2.4
    // @description  è‡ªåŠ¨æ·»åŠ è´¦å·æ•°æ®åˆ°Claude-Shareç½‘ç«™ï¼Œæ”¯æŒåªè¾“å…¥sessionkeyè‡ªåŠ¨ç”Ÿæˆéšæœºé‚®ç®±å¯†ç ï¼Œè‡ªåŠ¨å¯ç”¨çŠ¶æ€å¼€å…³ã€‚
    // @author       Claude (Modified)
    // @match        xxx/*
    // @grant        GM_addStyle
    // @grant        GM_notification
    // ==/UserScript==
    
    (function() {
        'use strict';
    
        // æ·»åŠ æ ·å¼
        GM_addStyle(`
            .auto-add-panel {
                position: fixed;
                top: 80px;
                right: 20px;
                width: 450px;
                background: white;
                border: 3px solid #667eea;
                border-radius: 10px;
                box-shadow: 0 8px 32px rgba(0,0,0,0.3);
                z-index: 999999;
                font-family: Arial, sans-serif;
            }
            .auto-add-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 12px 15px;
                font-weight: bold;
                cursor: move;
                border-radius: 7px 7px 0 0;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            .auto-add-body {
                padding: 15px;
                max-height: 600px;
                overflow-y: auto;
            }
            .config-box {
                background: #f5f5f5;
                padding: 10px;
                border-radius: 5px;
                margin-bottom: 10px;
            }
            .config-row {
                display: flex;
                align-items: center;
                margin: 8px 0;
                font-size: 13px;
            }
            .config-label {
                width: 110px;
                color: #333;
            }
            .config-input {
                flex: 1;
                padding: 5px 8px;
                border: 1px solid #ddd;
                border-radius: 3px;
            }
            .data-input {
                width: 100%;
                height: 150px;
                padding: 8px;
                border: 2px solid #ddd;
                border-radius: 5px;
                font-family: monospace;
                font-size: 11px;
                margin-bottom: 10px;
                resize: vertical;
            }
            .btn-group {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 8px;
                margin-bottom: 10px;
            }
            .btn {
                padding: 8px 12px;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-weight: bold;
                font-size: 12px;
            }
            .btn-start { background: #4CAF50; color: white; }
            .btn-pause { background: #FF9800; color: white; }
            .btn-stop { background: #f44336; color: white; }
            .btn-clear { background: #607D8B; color: white; }
            .btn-hide { background: #9E9E9E; color: white; }
            .btn:hover { opacity: 0.9; transform: translateY(-1px); }
            .log-box {
                background: #fafafa;
                border: 1px solid #ddd;
                border-radius: 5px;
                padding: 8px;
                height: 180px;
                overflow-y: auto;
                font-family: monospace;
                font-size: 11px;
                margin-bottom: 10px;
            }
            .log-item {
                margin: 3px 0;
                padding: 4px 6px;
                border-radius: 3px;
            }
            .log-info { background: #e3f2fd; color: #1565c0; }
            .log-success { background: #e8f5e9; color: #2e7d32; }
            .log-warning { background: #fff3e0; color: #ef6c00; }
            .log-error { background: #ffebee; color: #c62828; }
            .status-bar {
                display: flex;
                justify-content: space-between;
                font-size: 12px;
                color: #666;
                padding: 8px;
                background: #f5f5f5;
                border-radius: 5px;
            }
            .close-btn {
                background: rgba(255,255,255,0.2);
                border: none;
                color: white;
                width: 24px;
                height: 24px;
                border-radius: 50%;
                cursor: pointer;
                font-size: 18px;
                line-height: 1;
            }
        `);
    
        // å…¨å±€å˜é‡
        let running = false;
        let paused = false;
        let currentIdx = 0;
        let items = [];
    
        // æ—¥å¿—
        const log = {
            container: null,
            add(msg, type = 'info') {
                if (!this.container) return;
                const div = document.createElement('div');
                div.className = `log-item log-${type}`;
                const time = new Date().toLocaleTimeString();
                div.textContent = `[${time}] ${msg}`;
                this.container.appendChild(div);
                this.container.scrollTop = this.container.scrollHeight;
            },
            clear() {
                if (this.container) this.container.innerHTML = '';
            }
        };
    
        // ç”Ÿæˆè½¦å·
        function makeCarId(prefix) {
            const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
            let id = prefix === 'auto' ? '' : prefix;
            while (id.length < 8) {
                id += chars[Math.floor(Math.random() * chars.length)];
            }
            return id;
        }
    
        // ç”Ÿæˆéšæœºé‚®ç®±
        function generateRandomEmail() {
            const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
            const domains = ['gmail.com', 'outlook.com', 'yahoo.com', 'hotmail.com', 'proton.me'];
            let username = '';
            const length = Math.floor(Math.random() * 5) + 8; // 8-12ä½
            for (let i = 0; i < length; i++) {
                username += chars[Math.floor(Math.random() * chars.length)];
            }
            const domain = domains[Math.floor(Math.random() * domains.length)];
            return `${username}@${domain}`;
        }
    
        // ç”Ÿæˆéšæœºå¯†ç 
        function generateRandomPassword() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';
            let password = '';
            const length = Math.floor(Math.random() * 5) + 12; // 12-16ä½
            for (let i = 0; i < length; i++) {
                password += chars[Math.floor(Math.random() * chars.length)];
            }
            return password;
        }
    
        // è§£ææ•°æ®
        function parseInput(text) {
            const lines = text.split('\n').filter(l => l.trim());
            const result = [];
            lines.forEach((line, i) => {
                const trimmedLine = line.trim();
                // æ”¯æŒä¸¤ç§æ ¼å¼ï¼š
                // 1. åªè¾“å…¥ sessionkeyï¼ˆä¸€è¡Œä¸€ä¸ªï¼‰
                // 2. åŸæ ¼å¼ï¼šé‚®ç®±----å¯†ç ----sessionkey
                if (trimmedLine.includes('----')) {
                    // åŸæ ¼å¼
                    const parts = trimmedLine.split('----').map(p => p.trim());
                    if (parts.length === 3 && parts[0] && parts[1] && parts[2]) {
                        result.push({
                            email: parts[0],
                            password: parts[1],
                            sessionkey: parts[2]
                        });
                    } else {
                        log.add(`ç¬¬${i+1}è¡Œæ ¼å¼é”™è¯¯`, 'error');
                    }
                } else if (trimmedLine.length > 0) {
                    // æ–°æ ¼å¼ï¼šåªæœ‰ sessionkeyï¼Œè‡ªåŠ¨ç”Ÿæˆé‚®ç®±å’Œå¯†ç 
                    result.push({
                        email: generateRandomEmail(),
                        password: generateRandomPassword(),
                        sessionkey: trimmedLine
                    });
                    log.add(`ç¬¬${i+1}è¡Œ: è‡ªåŠ¨ç”Ÿæˆé‚®ç®±å’Œå¯†ç `, 'info');
                }
            });
            return result;
        }
    
        // ç­‰å¾…å…ƒç´ 
        function waitEl(selector, timeout = 10000) {
            return new Promise((resolve, reject) => {
                const start = Date.now();
                const check = () => {
                    if (paused) {
                        setTimeout(check, 100);
                        return;
                    }
                    const el = document.querySelector(selector);
                    if (el) resolve(el);
                    else if (Date.now() - start > timeout) reject(new Error('è¶…æ—¶'));
                    else setTimeout(check, 100);
                };
                check();
            });
        }
    
        // è®¾ç½®è¾“å…¥å€¼
        function setVal(el, val) {
            if (!el) return false;
            el.value = val;
            el.dispatchEvent(new Event('input', { bubbles: true }));
            el.dispatchEvent(new Event('change', { bubbles: true }));
            return true;
        }
    
        // æŸ¥æ‰¾æ–°å¢æŒ‰é’®
        function findAddBtn() {
            const btns = document.querySelectorAll('button');
            for (const btn of btns) {
                if (btn.textContent.includes('æ–°å¢') && !btn.disabled) {
                    const parent = btn.closest('.cl-search-key');
                    if (!parent) return btn; // æ’é™¤æœç´¢åŒºåŸŸ
                }
            }
            return null;
        }
    
        // æ£€æŸ¥å¯¹è¯æ¡†
        function hasDialog() {
            const overlays = document.querySelectorAll('.el-overlay');
            for (const o of overlays) {
                if (window.getComputedStyle(o).display !== 'none') {
                    return true;
                }
            }
            return false;
        }
    
        // å…³é—­å¯¹è¯æ¡†
        async function closeDialog() {
            const btn = document.querySelector('.el-dialog__close, .close');
            if (btn) {
                btn.click();
                await new Promise(r => setTimeout(r, 500));
            }
        }
    
        // å¡«å†™è¡¨å•
        async function fillForm(data, idx, total) {
            try {
                const carId = makeCarId(document.getElementById('carPrefix').value);
                log.add(`[${idx+1}/${total}] å¡«å†™: ${data.email}`, 'info');
    
                await new Promise(r => setTimeout(r, 800));
    
                const dialog = document.querySelector('.el-dialog');
                if (!dialog) {
                    log.add('æœªæ‰¾åˆ°å¯¹è¯æ¡†', 'error');
                    return false;
                }
    
                // è½¦å·
                let input = dialog.querySelector('input[placeholder*="è½¦å·"]');
                if (input) {
                    setVal(input, carId);
                    log.add(`  è½¦å·: ${carId}`, 'success');
                } else {
                    log.add('  æœªæ‰¾åˆ°è½¦å·æ¡†', 'error');
                }
    
                // é‚®ç®±
                input = dialog.querySelector('input[placeholder*="é‚®ç®±"]');
                if (input) {
                    setVal(input, data.email);
                    log.add(`  é‚®ç®±: ${data.email}`, 'success');
                } else {
                    log.add('  æœªæ‰¾åˆ°é‚®ç®±æ¡†', 'error');
                }
    
                // å¯†ç 
                input = dialog.querySelector('input[placeholder*="å¯†ç "]');
                if (input) {
                    setVal(input, data.password);
                    log.add(`  å¯†ç : ***`, 'success');
                } else {
                    log.add('  æœªæ‰¾åˆ°å¯†ç æ¡†', 'error');
                }
    
                // sessionkey
                const textarea = dialog.querySelector('textarea[placeholder*="session"]');
                if (textarea) {
                    textarea.value = data.sessionkey;
                    textarea.dispatchEvent(new Event('input', { bubbles: true }));
                    textarea.dispatchEvent(new Event('change', { bubbles: true }));
                    await new Promise(r => setTimeout(r, 300));
                    if (textarea.value === data.sessionkey) {
                        log.add(`  sessionkey: ${data.sessionkey.substring(0,25)}...`, 'success');
                    } else {
                        log.add('  sessionkeyå¡«å†™å¤±è´¥', 'error');
                        return false;
                    }
                } else {
                    log.add('  æœªæ‰¾åˆ°sessionkeyæ¡†', 'error');
                    return false;
                }
    
                // çŠ¶æ€å¼€å…³ - è‡ªåŠ¨å‹¾é€‰
                const statusSwitch = dialog.querySelector('.el-switch input[type="checkbox"]');
                if (statusSwitch && !statusSwitch.checked) {
                    // ç‚¹å‡»å¼€å…³æ¥æ¿€æ´»
                    const switchCore = dialog.querySelector('.el-switch__core');
                    if (switchCore) {
                        switchCore.click();
                        log.add(`  çŠ¶æ€: å·²å¯ç”¨`, 'success');
                        await new Promise(r => setTimeout(r, 200));
                    }
                } else if (statusSwitch && statusSwitch.checked) {
                    log.add(`  çŠ¶æ€: å·²å¯ç”¨`, 'success');
                }
    
                return true;
    
            } catch (e) {
                log.add(`å¡«å†™å¼‚å¸¸: ${e.message}`, 'error');
                return false;
            }
        }
    
        // ä¿å­˜
        async function save() {
            const dialog = document.querySelector('.el-dialog');
            if (!dialog) return false;
    
            const btns = dialog.querySelectorAll('button');
            for (const btn of btns) {
                if (btn.textContent.includes('ä¿å­˜')) {
                    btn.click();
                    log.add('ç‚¹å‡»ä¿å­˜', 'info');
                    return true;
                }
            }
            return false;
        }
    
        // ç­‰å¾…å…³é—­
        async function waitClose(timeout = 15000) {
            const wait = parseInt(document.getElementById('saveWait').value) || 5000;
            const start = Date.now();
            return new Promise(resolve => {
                const check = () => {
                    if (paused) {
                        setTimeout(check, 100);
                        return;
                    }
                    if (!hasDialog()) {
                        resolve(true);
                    } else if (Date.now() - start > timeout) {
                        log.add('ä¿å­˜è¶…æ—¶', 'warning');
                        closeDialog();
                        resolve(false);
                    } else {
                        setTimeout(check, 100);
                    }
                };
                check();
            });
        }
    
        // ä¸»æµç¨‹
        async function start() {
            const text = document.getElementById('dataInput').value.trim();
            if (!text) {
                log.add('è¯·è¾“å…¥æ•°æ®', 'warning');
                return;
            }
    
            items = parseInput(text);
            if (items.length === 0) {
                log.add('æ— æœ‰æ•ˆæ•°æ®', 'warning');
                return;
            }
    
            running = true;
            paused = false;
            currentIdx = 0;
    
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'block';
            document.getElementById('stopBtn').style.display = 'block';
    
            let ok = 0, fail = 0;
            const interval = parseInt(document.getElementById('interval').value) || 3000;
    
            log.add(`å¼€å§‹å¤„ç† ${items.length} æ¡`, 'info');
            updateStatus('è¿è¡Œä¸­', `0/${items.length}`);
    
            while (currentIdx < items.length && running) {
                if (paused) {
                    await new Promise(r => setTimeout(r, 500));
                    continue;
                }
    
                const item = items[currentIdx];
                updateStatus('å¤„ç†ä¸­', `${currentIdx+1}/${items.length}`);
    
                try {
                    if (hasDialog()) {
                        await closeDialog();
                    }
    
                    const addBtn = findAddBtn();
                    if (!addBtn) {
                        log.add(`[${currentIdx+1}] æœªæ‰¾åˆ°æ–°å¢æŒ‰é’®`, 'error');
                        fail++;
                        currentIdx++;
                        continue;
                    }
    
                    addBtn.click();
                    log.add(`[${currentIdx+1}] ç‚¹å‡»æ–°å¢`, 'info');
    
                    await waitEl('.el-dialog', 8000);
    
                    const filled = await fillForm(item, currentIdx, items.length);
                    if (!filled) {
                        log.add(`[${currentIdx+1}] å¡«å†™å¤±è´¥`, 'error');
                        await closeDialog();
                        fail++;
                        currentIdx++;
                        continue;
                    }
    
                    const saved = await save();
                    if (!saved) {
                        log.add(`[${currentIdx+1}] ä¿å­˜å¤±è´¥`, 'error');
                        await closeDialog();
                        fail++;
                        currentIdx++;
                        continue;
                    }
    
                    const closed = await waitClose();
                    if (closed) {
                        log.add(`[${currentIdx+1}] âœ“ æˆåŠŸ`, 'success');
                        ok++;
                    } else {
                        log.add(`[${currentIdx+1}] å¯èƒ½å¤±è´¥`, 'warning');
                        fail++;
                    }
    
                    currentIdx++;
    
                    if (currentIdx < items.length) {
                        await new Promise(r => setTimeout(r, interval));
                    }
    
                } catch (e) {
                    log.add(`[${currentIdx+1}] å¼‚å¸¸: ${e.message}`, 'error');
                    fail++;
                    currentIdx++;
                }
            }
    
            running = false;
            document.getElementById('startBtn').style.display = 'block';
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('stopBtn').style.display = 'none';
    
            const msg = `å®Œæˆ! æˆåŠŸ${ok}æ¡, å¤±è´¥${fail}æ¡`;
            log.add(msg, ok > 0 ? 'success' : 'error');
            updateStatus('å®Œæˆ', msg);
    
            if (ok > 0) {
                GM_notification({
                    text: `æˆåŠŸæ·»åŠ ${ok}æ¡è´¦å·`,
                    title: 'å®Œæˆ',
                    timeout: 3000
                });
            }
        }
    
        function togglePause() {
            paused = !paused;
            const btn = document.getElementById('pauseBtn');
            btn.textContent = paused ? 'ç»§ç»­' : 'æš‚åœ';
            log.add(paused ? 'å·²æš‚åœ' : 'ç»§ç»­', 'warning');
        }
    
        function stop() {
            running = false;
            paused = false;
            document.getElementById('startBtn').style.display = 'block';
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('stopBtn').style.display = 'none';
            log.add('å·²åœæ­¢', 'warning');
        }
    
        function clear() {
            document.getElementById('dataInput').value = '';
            log.clear();
            updateStatus('å°±ç»ª', '0/0');
        }
    
        function updateStatus(status, progress) {
            document.getElementById('status').textContent = status;
            document.getElementById('progress').textContent = progress;
        }
    
        // åˆ›å»ºé¢æ¿
        function createPanel() {
            const panel = document.createElement('div');
            panel.className = 'auto-add-panel';
            panel.innerHTML = `
                <div class="auto-add-header">
                    <span>ğŸš€ è‡ªåŠ¨æ·»åŠ å·¥å…· v2.4 (è‡ªåŠ¨å¯ç”¨çŠ¶æ€)</span>
                    <button class="close-btn" id="hideBtn">Ã—</button>
                </div>
                <div class="auto-add-body">
                    <div class="config-box">
                        <div class="config-row">
                            <span class="config-label">è½¦å·å‰ç¼€:</span>
                            <input class="config-input" id="carPrefix" value="auto">
                        </div>
                        <div class="config-row">
                            <span class="config-label">æ·»åŠ é—´éš”(ms):</span>
                            <input class="config-input" type="number" id="interval" value="3000">
                        </div>
                        <div class="config-row">
                            <span class="config-label">ä¿å­˜ç­‰å¾…(ms):</span>
                            <input class="config-input" type="number" id="saveWait" value="5000">
                        </div>
                    </div>
                    <textarea class="data-input" id="dataInput" placeholder="æ”¯æŒä¸¤ç§æ ¼å¼ï¼š&#10;1. åªè¾“å…¥sessionkeyï¼ˆæ¨èï¼‰&#10;sk-ant-sid01-xxx&#10;sk-ant-sid01-yyy&#10;&#10;2. å®Œæ•´æ ¼å¼&#10;é‚®ç®±----å¯†ç ----sessionkey&#10;user@test.com----pass123----sk-ant-sid01-xxx"></textarea>
                    <div class="btn-group">
                        <button class="btn btn-start" id="startBtn">å¼€å§‹</button>
                        <button class="btn btn-pause" id="pauseBtn" style="display:none">æš‚åœ</button>
                        <button class="btn btn-stop" id="stopBtn" style="display:none">åœæ­¢</button>
                        <button class="btn btn-clear" id="clearBtn">æ¸…ç©º</button>
                    </div>
                    <div class="log-box" id="logBox"></div>
                    <div class="status-bar">
                        <span id="status">å°±ç»ª</span>
                        <span id="progress">0/0</span>
                    </div>
                </div>
            `;
            document.body.appendChild(panel);
    
            // æ‹–æ‹½
            const header = panel.querySelector('.auto-add-header');
            let dragging = false;
            let offsetX = 0, offsetY = 0;
    
            header.addEventListener('mousedown', e => {
                if (e.target.id === 'hideBtn') return;
                dragging = true;
                offsetX = e.clientX - panel.offsetLeft;
                offsetY = e.clientY - panel.offsetTop;
            });
    
            document.addEventListener('mousemove', e => {
                if (!dragging) return;
                panel.style.left = (e.clientX - offsetX) + 'px';
                panel.style.top = (e.clientY - offsetY) + 'px';
                panel.style.right = 'auto';
            });
    
            document.addEventListener('mouseup', () => {
                dragging = false;
            });
    
            // ç»‘å®šäº‹ä»¶
            document.getElementById('startBtn').onclick = start;
            document.getElementById('pauseBtn').onclick = togglePause;
            document.getElementById('stopBtn').onclick = stop;
            document.getElementById('clearBtn').onclick = clear;
            document.getElementById('hideBtn').onclick = () => {
                panel.style.display = 'none';
            };
    
            log.container = document.getElementById('logBox');
    
            return panel;
        }
    
        // å¿«æ·é”®æ˜¾ç¤º/éšè—
        document.addEventListener('keydown', e => {
            if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                e.preventDefault();
                const panel = document.querySelector('.auto-add-panel');
                if (panel) {
                    panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                }
            }
        });
    
        // åˆå§‹åŒ–
        function init() {
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', () => {
                    setTimeout(() => {
                        const panel = createPanel();
                        log.add('å·¥å…·å·²åŠ è½½ v2.4', 'success');
                        log.add('æŒ‰ Ctrl+Shift+A æ˜¾ç¤º/éšè—', 'info');
                    }, 1000);
                });
            } else {
                setTimeout(() => {
                    const panel = createPanel();
                    log.add('å·¥å…·å·²åŠ è½½ v2.4', 'success');
                    log.add('æŒ‰ Ctrl+Shift+A æ˜¾ç¤º/éšè—', 'info');
                }, 1000);
            }
        }
    
        init();
    
    })();
    

